define(["rias"],function(c){function l(a){a=c.concat([],a);return a=a.join(",\n")}console=c.mixin(console,{log:function(a){c.log(1,"console",l(arguments))},debug:function(a){c.log(0,"console",l(arguments))},message:function(a){c.log(1,"console",l(arguments))},info:function(a){c.log(1,"console",l(arguments))},warn:function(a){c.log(2,"console",l(arguments))},error:function(a){c.log(3,"console",l(arguments))}});var b=javax.servlet.http.HttpServletResponse;c.host={_typeStr:"s",_typeString:"s",_typeNum:"n",_typeNumber:"n",_typeBool:"b",_typeBoolean:"b",_typeDate:"dt",_typeDatetime:"dt",_typeObj:"o",_typeObject:"o",_typeArray:"a",SysUtil:com.riastudio.util.SysUtil,WebUtil:com.riastudio.util.WebUtil,FileUtil:com.riastudio.util.FileUtil,DbUtil:com.riastudio.util.DbUtil,TaskUtil:com.riastudio.util.TaskUtil,ServerEnv:com.riastudio.server.ServerEnv,responseCode:{SC_CONTINUE:b.SC_CONTINUE,SC_SWITCHING_PROTOCOLS:b.SC_SWITCHING_PROTOCOLS,SC_OK:b.SC_OK,SC_CREATED:b.SC_CREATED,SC_ACCEPTED:b.SC_ACCEPTED,SC_NON_AUTHORITATIVE_INFORMATION:b.SC_NON_AUTHORITATIVE_INFORMATION,SC_NO_CONTENT:b.SC_NO_CONTENT,SC_RESET_CONTENT:b.SC_RESET_CONTENT,SC_PARTIAL_CONTENT:b.SC_PARTIAL_CONTENT,SC_MULTIPLE_CHOICES:b.SC_MULTIPLE_CHOICES,SC_MOVED_PERMANENTLY:b.SC_MOVED_PERMANENTLY,SC_MOVED_TEMPORARILY:b.SC_MOVED_TEMPORARILY,SC_FOUND:b.SC_FOUND,SC_SEE_OTHER:b.SC_SEE_OTHER,SC_NOT_MODIFIED:b.SC_NOT_MODIFIED,SC_USE_PROXY:b.SC_USE_PROXY,SC_TEMPORARY_REDIRECT:b.SC_TEMPORARY_REDIRECT,SC_BAD_REQUEST:b.SC_BAD_REQUEST,SC_UNAUTHORIZED:b.SC_UNAUTHORIZED,SC_PAYMENT_REQUIRED:b.SC_PAYMENT_REQUIRED,SC_FORBIDDEN:b.SC_FORBIDDEN,SC_NOT_FOUND:b.SC_NOT_FOUND,SC_METHOD_NOT_ALLOWED:b.SC_METHOD_NOT_ALLOWED,SC_NOT_ACCEPTABLE:b.SC_NOT_ACCEPTABLE,SC_PROXY_AUTHENTICATION_REQUIRED:b.SC_PROXY_AUTHENTICATION_REQUIRED,SC_REQUEST_TIMEOUT:b.SC_REQUEST_TIMEOUT,SC_CONFLICT:b.SC_CONFLICT,SC_GONE:b.SC_GONE,SC_LENGTH_REQUIRED:b.SC_LENGTH_REQUIRED,SC_PRECONDITION_FAILED:b.SC_PRECONDITION_FAILED,SC_REQUEST_ENTITY_TOO_LARGE:b.SC_REQUEST_ENTITY_TOO_LARGE,SC_REQUEST_URI_TOO_LONG:b.SC_REQUEST_URI_TOO_LONG,SC_UNSUPPORTED_MEDIA_TYPE:b.SC_UNSUPPORTED_MEDIA_TYPE,SC_REQUESTED_RANGE_NOT_SATISFIABLE:b.SC_REQUESTED_RANGE_NOT_SATISFIABLE,SC_EXPECTATION_FAILED:b.SC_EXPECTATION_FAILED,SC_INTERNAL_SERVER_ERROR:b.SC_INTERNAL_SERVER_ERROR,SC_NOT_IMPLEMENTED:b.SC_NOT_IMPLEMENTED,SC_BAD_GATEWAY:b.SC_BAD_GATEWAY,SC_SERVICE_UNAVAILABLE:b.SC_SERVICE_UNAVAILABLE,SC_GATEWAY_TIMEOUT:b.SC_GATEWAY_TIMEOUT,SC_HTTP_VERSION_NOT_SUPPORTED:b.SC_HTTP_VERSION_NOT_SUPPORTED},getSynLock:function(a){return this.ServerEnv.getSynLock(a)},synchronize:function(a,d){c.isString(d)?d=this.getSynLock(d):d instanceof java.util.concurrent.locks.ReentrantLock()||(d=new java.util.concurrent.locks.ReentrantLock);return function(){d.lock();try{return a.apply(this,arguments)}finally{d.unlock()}}},jsString:function(a){return a+""},jsNumber:function(a){return Number(this.jsString(a))},jsBoolean:function(a){return"false"!=a&&!!a},jsDatetime:function(a){return new Date(a+"")},jsArray:function(a){for(var d=0,b=a&&a.size()||0,c=[];d<b;++d)c.push(a.get(d));return c},jsType:function(a,d){switch(d){case this._typeStr:return this.jsString(a);case this._typeNum:return this.jsNumber(a);case this._typeBool:return this.jsBoolean(a);case this._typeDate:return this.jsDatetime(a);case this._typeArray:return this.jsArray(a);default:return a}},newThread:function(a){return new java.lang.Thread(a)},currentThread:function(){return java.lang.Thread.currentThread()},newString:function(a){return new java.lang.String(a)},newFile:function(a,d){return d?new java.io.File(a,d):new java.io.File(a)},getFilePathName:function(a){return this.jsString(a.getCanonicalPath()).replace(/\\/g,"/")},getFileExt:function(a){a=this.getFilePathName(a);var d=a.lastIndexOf(".");return-1<d?a.substring(d+1):""},fileSize:function(a){return a.length()},fileLastModified:function(a){return a.lastModified()},fileExists:function(a){return a.exists()},isFile:function(a){return a.isFile()},isDirectory:function(a){return a.isDirectory()},createNewFile:function(a){return this.synchronize(function(){return a.createNewFile()},"host-createNewFile")()},createNewDir:function(a){return this.synchronize(function(){return a.mkdirs()},"host-createNewDir")()},deleteFile:function(a){return this.synchronize(function(){return a["delete"]()},"host-deleteFile")()},copyFile:function(a,d,b,c){var h=this;return this.synchronize(function(){try{return h.FileUtil.copyFile(a,d,!!b,!!c),1}catch(g){return 0}},"host-copyFile")()},readText:function(a,d){c.isString(a)&&(a=new java.io.File(a));var b=this;return this.synchronize(function(){return b.jsString(b.FileUtil.readText(a,d||"utf-8"))},"host-readText")()},writeText:function(a,d,b){c.isString(a)&&(a=new java.io.File(a));var h=this;return this.synchronize(function(){try{return h.FileUtil.writeText(a,d,b||"utf-8"),1}catch(f){return 0}},"host-writeText")()},saveStreamToFile:function(a,d){this.FileUtil.saveStream(a,d)},listFiles:function(a){return a.listFiles()},sortFiles:function(a,d,b){function c(a,d){var b,c,e,f;switch(h){case "size":case 1:return b=a.isDirectory()?-1:a.length(),c=d.isDirectory()?-1:d.length(),g?c.compareTo(b):b.compareTo(c);case "type":case 2:return b=k.getCollationKey(a.isDirectory()?"0":"1"+this.getFileExt(a).toLowerCase()),c=k.getCollationKey(d.isDirectory()?"0":"1"+this.getFileExt(d).toLowerCase()),g?c.compareTo(b):b.compareTo(c);case "lastModified":case 3:return b=a.lastModified(),c=d.lastModified(),e=a.isDirectory(),f=d.isDirectory(),e&&!f&&(b=Number.MIN_VALUE),f&&!e&&(c=Number.MIN_VALUE),g?c.compareTo(b):b.compareTo(c);default:return b=k.getCollationKey((a.isDirectory()?0:1)+a.getName().toLowerCase()),c=k.getCollationKey((d.isDirectory()?0:1)+d.getName().toLowerCase()),g?c.compareTo(b):b.compareTo(c)}}var h=d||-1,g=b||0,k=java.text.Collator.getInstance();a&&a.sort(c)},debugLevel:function(){return this.SysUtil.debugLevel},toBuff:function(a,b){return b?this.SysUtil.toBuff(a,b):this.SysUtil.toBuff(a)},newBuff:function(a){return this.SysUtil.newBuff(a)},newCache:function(){return this.SysUtil.newCache()},inputToOutput:function(a,b){return this.SysUtil.isToOs(a,b)},readStream:function(a){return this.jsString(this.SysUtil.readString(a))},isRequest:function(a){return a instanceof javax.servlet.http.HttpServletRequest},getRemoteIp:function(a){return this.isRequest(a)?this.WebUtil.getRemoteIp(a,!1):"0"},encodeFilename:function(a,b){return this.jsString(this.WebUtil.encodeFilename(a,b))},sftpDownload:function(a,b,c,e,f,g,k){var d=this.WebUtil.sftpLogin(a,b,c,e);if(d)try{var h=this.WebUtil.sftpDownload(d,f,g,k);this.WebUtil.sftpLogout(d);return this.getFilePathName(h)}catch(n){console.error("sftpDownload error: ",a,b,c,e,f,g,k)}return!1},tcpSend:function(a,b,h,e,f){return this.WebUtil.tcpSend(a+"",Number(b),h+"",c.toInt(e,0),f+"")+""},dbInitConnection:function(a,b){return this.DbUtil.initConnection(c.toStr(a),b)},dbToJSONArray:function(a,b){return this.DbUtil.toJSONArray(a,c.toInt(b))},uploadFile:function(a,b,c,e){return this.WebUtil.uploadFile(a,b,c||"",e||"")},toExcel:function(a,b,c){return this.WebUtil.toExcel(a,b,c)},runActionTask:function(a,b,c,e,f,g){this.TaskUtil.runActionTask(a,b,c,e,f,g)},removeTask:function(a,b){this.TaskUtil.removeTask(a,b)}};c.requireLock=c.host.getSynLock("require");var m=c.require;c.synRequire=function(){c.requireLock.lock();try{return m.apply(this,arguments)}finally{c.requireLock.unlock()}};return c});