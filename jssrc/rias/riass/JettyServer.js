define(["rias/riass/riass","rias/riass/WebServer"],function(b,g){return b.declare("rias.riass.JettyServer",[g],{loadServlets:function(c,a){var d=this;b.forEach(a,function(a){b.log(1,"WebServer","Loading Servlet ..."+a.module);/action$/.test(a.module)&&!d._cacheAction&&(d._cacheAction=b.host.newCache());b.require([d.appName+"/serverApp/"+a.module],function(e){c.addServlet(new org.eclipse.jetty.servlet.ServletHolder(new javax.servlet.http.HttpServlet({service:b.hitch(d,e)})),a.url);b.log(1,"WebServer",a.module+" Loaded.")})})},startWebServer:function(c){b.log(1,"WebServer","Starting JettyServer ...");try{var a=b.webServer[this.appName];if(b.isObjectExact(a))try{a.stop()}catch(d){b.log(3,"WebServer","Stop JettyServer Error: "+d+"\n"+d.javaException)}var a=b.webServer[this.appName]=new org.eclipse.jetty.server.Server,h=new org.eclipse.jetty.util.thread.QueuedThreadPool;h.setMinThreads(c.minThreads);h.setMaxThreads(c.maxThreads);a.setThreadPool(h);var e=new org.eclipse.jetty.server.nio.SelectChannelConnector;e.setPort(c.port);e.setAcceptors(c.acceptors);a.setConnectors([e]);var f=new org.eclipse.jetty.webapp.WebAppContext(this.path.appRoot+"/webApp",c.webContext),g=b.host.currentThread();f.setClassLoader(g.getContextClassLoader());f.setParentLoaderPriority(!0);a.setHandler(f);this.loadServlets(f,c.servlet);c.maxFormContentSize&&a.setAttribute("org.eclipse.jetty.server.Request.maxFormContentSize",c.maxFormContentSize);a.start();b.log(1,"WebServer","JettyServer started at "+c.port+"\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d")}catch(k){b.log(3,"WebServer","Start JettyServer Error: "+k+"\n"+k.javaException)}}})});